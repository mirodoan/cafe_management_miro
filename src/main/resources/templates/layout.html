<!DOCTYPE html>
<html
  lang="vi"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
>
  <head>
    <meta charset="UTF-8" />
    <title layout:title-pattern="$CONTENT_TITLE - Cafe Management">
      Cafe Management
    </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script th:src="@{/js/alert-utils.js}"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link th:href="@{/css/main.css}" rel="stylesheet" />
  </head>
  <body
    style="
      background: var(--color-background-main);
      color: var(--color-text-main);
      font-family: var(--font-family-main);
    "
    class="layout-root"
  >
    <header
      style="
        background: linear-gradient(
          to right,
          var(--color-primary),
          var(--color-text-main)
        );
        color: white;
      "
      class="shadow-lg"
    >
      <div
        style="
          display: flex;
          align-items: center;
          justify-content: space-between;
          height: 100%;
          padding: 0 2rem 0 0;
          min-height: 64px;
        "
      >
        <div
          class="header-logo"
          style="
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-left: 0;
            padding-left: 2rem;
          "
        >
          <i
            class="fas fa-mug-hot"
            style="font-size: 2.5rem; color: var(--color-secondary)"
          ></i>
          <span style="font-size: 2rem; font-weight: bold; letter-spacing: 1px">
            <span style="color: var(--color-secondary)">Cafe</span>
            <span style="color: #fff">Hub</span>
          </span>
        </div>
        <div class="flex items-center gap-4">
          <div class="hidden sm:block text-sm text-right">
            <div class="font-semibold" th:text="${user.username}">
              T√™n ƒëƒÉng nh·∫≠p
            </div>
            <div
              class="text-gray-300 text-xs"
              th:text="'Ch·ª©c v·ª•: ' + ${user.permission}"
            >
              Ch·ª©c v·ª•
            </div>
          </div>
          <img
            th:src="${user.imageUrl}"
            alt="avatar"
            class="w-8 h-8 rounded-full border"
          />

          <form th:action="@{/logout}" method="post">
            <button
              type="submit"
              class="px-3 py-1 text-sm text-white bg-red-500 rounded shadow hover:bg-red-600"
            >
              ƒêƒÉng xu·∫•t
            </button>
          </form>
        </div>
      </div>
    </header>

    <div
      class="layout-page"
      style="display: flex; flex-direction: column; min-height: 100vh"
    >
      <div class="layout-main" style="flex: 1; display: flex">
        <aside class="sidebar w-80 p-4">
          <div class="flex flex-col space-y-2 h-full">
            <a
              th:href="@{/home}"
              th:classappend="${currentPath == '/home'} ? 'active' : ''"
              class="sidebar-link"
              ><i class="fas fa-home"></i> Trang ch·ªß</a
            >
            <a
              th:href="@{/account}"
              th:classappend="${currentPath == '/account'} ? 'active' : ''"
              class="sidebar-link"
              ><i class="fas fa-user-circle"></i> Trang c√° nh√¢n</a
            >
            <a
              th:href="@{/sale}"
              th:classappend="${currentPath == '/sale'} ? 'active' : ''"
              class="sidebar-link"
              ><i class="fas fa-shopping-cart"></i> Qu·∫£n l√Ω b√°n h√†ng</a
            >
            <div th:if="${user.permission == 'ADMIN'}">
              <a
                th:href="@{/employee}"
                th:classappend="${#strings.startsWith(currentPath, '/employee')} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-users"></i> Qu·∫£n l√Ω nh√¢n vi√™n</a
              >
              <a
                th:href="@{/equipment}"
                th:classappend="${currentPath == '/equipment'} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-desktop"></i> Qu·∫£n l√Ω trang thi·∫øt b·ªã</a
              >

              <!-- Dropdown cho Qu·∫£n l√Ω kho h√†ng -->
              <div
                x-data="{ openWarehouse: false }"
                x-init="openWarehouse = '[[${#strings.startsWith(currentPath, '/warehouse')}]]' === 'true'"
                class="space-y-1"
              >
                <button
                  @click="openWarehouse = !openWarehouse"
                  th:classappend="${#strings.startsWith(currentPath, '/warehouse')} ? 'active' : ''"
                  class="sidebar-link w-full text-left flex justify-between items-center"
                  :class="{ 'bg-opacity-20': openWarehouse }"
                >
                  <span><i class="fas fa-warehouse"></i> Qu·∫£n l√Ω kho h√†ng</span>
                  <span
                    x-text="openWarehouse ? '‚ñ≤' : '‚ñº'"
                    class="text-sm"
                  ></span>
                </button>
                <div x-show="openWarehouse" x-transition class="pl-6 space-y-1">
                  <a
                    th:href="@{/warehouse/product}"
                    th:classappend="${currentPath == '/warehouse/product'} ? 'bg-blue-100 text-blue-800 font-semibold' : 'text-gray-700'"
                    class="block py-2 px-4 text-sm rounded hover:bg-gray-100 hover:bg-opacity-20 transition-colors duration-200"
                  >
                    üì¶ H√†ng h√≥a
                  </a>
                  <a
                    th:href="@{/warehouse/transaction}"
                    th:classappend="${currentPath == '/warehouse/transaction'} ? 'bg-green-100 text-green-800 font-semibold' : 'text-gray-700'"
                    class="block py-2 px-4 text-sm rounded hover:bg-gray-100 hover:bg-opacity-20 transition-colors duration-200"
                  >
                    üìä Nh·∫≠p xu·∫•t
                  </a>
                </div>
              </div>

              <a
                th:href="@{/menu}"
                th:classappend="${currentPath == '/menu'} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-book-open"></i> Qu·∫£n l√Ω th·ª±c ƒë∆°n</a
              >

              <a
                th:href="@{/promotion}"
                th:classappend="${currentPath == '/promotion'} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-bullhorn"></i> Qu·∫£n l√Ω Marketing</a
              >
              <a
                      th:href="@{/budget}"
                      th:classappend="${#strings.startsWith(currentPath, '/budget')} ? 'active' : ''"
                      class="sidebar-link"
              >
                <i class="fas fa-money-bill-alt"></i> Qu·∫£n l√Ω ng√¢n s√°ch
              </a>
              <!-- <a
                th:href="@{/data}"
                th:classappend="${currentPath == '/data'} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-database"></i> Qu·∫£n l√Ω D·ªØ li·ªáu</a
              > -->
              <a
                th:href="@{/report}"
                th:classappend="${currentPath == '/report'} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-chart-pie"></i> Th·ªëng k√™, b√°o c√°o</a
              >
              <hr class="sidebar-divider" />
              <a
                th:href="@{/about}"
                th:classappend="${currentPath == '/about'} ? 'active' : ''"
                class="sidebar-link"
                ><i class="fas fa-info-circle"></i> Gi·ªõi thi·ªáu</a
              >
            </div>
          </div>
        </aside>

        <main
          class="main-content flex-1 p-10"
          style="background: var(--color-background-main)"
          layout:fragment="content"
        >
          <!--            <div class="text-center mt-20">-->
          <div class="max-w-5xl mx-auto w-full">
            <h2
              class="text-5xl font-bold"
              style="
                color: var(--color-primary);
                text-shadow: 1px 1px 2px rgba(var(--color-primary-rgb), 0.15);
              "
              th:text="'Xin ch√†o, ' + ${user.username}"
            ></h2>
            <p class="mt-4 text-lg" style="color: var(--color-text-main)">
              Ch√∫c b·∫°n m·ªôt ng√†y l√†m vi·ªác hi·ªáu qu·∫£ v√† tr√†n ƒë·∫ßy nƒÉng l∆∞·ª£ng ‚òï‚ú®
            </p>
          </div>
        </main>
      </div>
      <div class="main-footer">
        <a href="#" class="main-footer-link"
          >¬© 2025 MirodoIT. All rights reserved.</a
        >
      </div>
    </div>

    <div th:replace="~{/alert :: alerts}"></div>
    <script th:src="@{/js/global.js}"></script>
  </body>
</html>
