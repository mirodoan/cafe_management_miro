<!DOCTYPE html>
<html
        lang="vi"
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layout}"
>
<head>
    <title>Quản lý bán hàng</title>
    <script src="/js/sales/table-select.js"></script>
    <script src="/js/sales/payment-table.js"></script>
    <script src="/js/sales/view-table.js"></script>
    <script src="/js/sales/select-menu-table.js"></script>
    <script src="/js/sales/reservation-table.js"></script>
    <script src="/js/sales/cancel-reservation-table.js"></script>
    <script src="/js/sales/move-table.js"></script>
    <script src="/js/sales/split-table.js"></script>
    <script src="/js/sales/merge-table.js"></script>

    <link rel="stylesheet" href="/css/sales.css"/>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<div layout:fragment="content">
    <div th:replace="~{alert :: alerts}"></div>
    <div class="flex flex-col">
        <main class="w-full">
            <div class="bg-[#fefae0] min-h-screen w-full responsive-spacing">
                <div class="sales-container">
                    <!-- Bỏ lớp nền trắng bg-white rounded-xl shadow-lg responsive-spacing -->
                    <!-- Tiêu đề responsive -->
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="page-title">
                            Danh sách bàn
                        </h2>
                    </div>
                    <!-- Grid layout hiển thị trạng thái bàn - Responsive -->
                    <div class="table-grid">
                        <!-- Render danh sách bàn động từ model -->
                        <div
                                th:each="table : ${tables}"
                                class="table-card"
                                th:classappend="${table.status.name() == 'AVAILABLE' ? 'table-available' : (table.status.name() == 'OCCUPIED' ? 'table-occupied' : (table.status.name() == 'RESERVED' ? 'table-reserved' : 'table-default'))}"
                                data-table
                                th:attr="data-status=${table.status.name()}, data-table-id=${table.id}"
                        >
                            <h3
                                    th:text="${table.tableName}"
                                    class="text-lg font-semibold text-gray-800 mb-2"
                            ></h3>
                            <p
                                    th:text="${table.status.name() == 'AVAILABLE' ? 'Trống' : (table.status.name() == 'OCCUPIED' ? 'Đang sử dụng' : (table.status.name() == 'RESERVED' ? 'Đã đặt' : 'Không xác định'))}"
                                    class="text-sm text-gray-600"
                            ></p>
                        </div>
                    </div>
                    <!-- Chức năng - Responsive Button Layout chia thành 2 hàng -->
                    <!-- Hàng 1: Các chức năng chính -->
                    <div class="action-buttons-container">
                        <button
                                id="view-table-button"
                                class="action-btn btn-blue"
                                type="button"
                        >
                            Xem bàn
                        </button>
                        <form
                                th:action="@{/sale/show-select-menu-form}"
                                method="get"
                                id="select-menu-form"
                                style="display: contents"
                        >
                            <!-- CSRF token: Bảo vệ chống tấn công Cross-Site Request Forgery -->
                            <input
                                    type="hidden"
                                    th:name="${_csrf.parameterName}"
                                    th:value="${_csrf.token}"
                            />
                            <input
                                    type="hidden"
                                    name="tableId"
                                    id="select-menu-table-id"
                            />
                            <button
                                    class="action-btn btn-orange"
                                    id="select-menu-button"
                                    type="submit"
                            >
                                Chọn thực đơn
                            </button>
                        </form>
                        <button
                                class="action-btn btn-teal"
                                id="payment-button"
                        >
                            Thanh toán
                        </button>
                        <button
                                type="button"
                                class="action-btn btn-purple"
                                id="reservation-button"
                        >
                            Đặt bàn
                        </button>
                    </div>
                    </button>
                    <!-- Hàng 2: Các chức năng quản lý bàn -->
                    <div class="action-buttons-container">
                        <button
                                id="move-table-button"
                                class="action-btn btn-green"
                                type="button"
                        >
                            Chuyển bàn
                        </button>
                        <button
                                id="split-table-button"
                                class="action-btn btn-yellow"
                                type="button"
                        >
                            Tách bàn
                        </button>
                        <button
                                id="merge-table-button"
                                class="action-btn btn-red"
                                type="button"
                        >
                            Gộp bàn
                        </button>
                        <button
                                id="cancel-table-button"
                                class="action-btn btn-gray"
                                type="button"
                        >
                            Hủy bàn
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <!-- Modal Merge Table Fragment -->
    <div th:replace="~{sales/merge_table :: merge-table-modal}"></div>
    <!-- Modal Merge Table Fragment -->
    <!-- Modal Split Table Fragment -->
    <div th:replace="~{sales/split_table :: split-table-modal}"></div>
    <!-- Modal Split Table Fragment -->
    <!-- Modal Move Table Fragment -->
    <div th:replace="~{sales/move_table :: move-table-modal}"></div>
    <!-- Modal Move Table Fragment -->
    <!-- Modal Cancel Reservation Fragment -->
    <div th:replace="~{sales/cancel_reservation :: cancel-reservation-modal}"></div>
    <!-- Modal Cancel Reservation Fragment -->
    <!-- Modal Reservation Fragment -->
    <div th:replace="~{sales/reservation :: reservation-modal}"></div>
    <!-- Modal Reservation Fragment -->
    <!-- Modal Select Menu Fragment -->
    <div th:replace="~{sales/select_menu :: select-menu-modal}"></div>
    <!-- Modal Select Menu Fragment -->
    <!-- Modal View Table Fragment -->
    <div th:replace="~{sales/view_details :: view-detail-modal}"></div>
    <!-- Modal View Table Fragment -->
    <!-- Modal Payment Fragment -->
    <div th:replace="~{sales/payment :: payment-modal}"></div>
</div>
</body>
</html>